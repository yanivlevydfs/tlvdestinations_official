{% extends "base.html" %}
{% block head %}
<!-- Canonical & hreflang for /stats -->
<link rel="canonical" href="https://fly-tlv.com/flights" />
<link rel="alternate" hreflang="en" href="https://fly-tlv.com/flights" />
<link rel="alternate" hreflang="he" href="https://fly-tlv.com/flights?lang=he" />

  <!-- âœ… Page-specific SEO -->
  <meta name="description" content="Live flight statistics from Ben Gurion Airport (TLV). Explore the top destinations, airlines, countries, and cities with departures and arrivals updated in real-time.">
  <meta name="keywords" content="Ben Gurion Airport, TLV flights, flight statistics, top destinations, airlines, arrivals, departures, Tel Aviv flights">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ben Gurion Airport â€” Current Flight Statistics | Fly-TLV">
  <meta property="og:description" content="See live statistics from Ben Gurion Airport (TLV). Explore top countries, cities, and airlines for departures and arrivals.">
  <meta property="og:url" content="https://fly-tlv.com/flights">
  <meta property="og:image" content="https://fly-tlv.com/static/og/flytlv_og.jpg">
  <meta property="og:image:alt" content="Ben Gurion Airport TLV statistics dashboard">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ben Gurion Airport â€” Current Flight Statistics | Fly-TLV">
  <meta name="twitter:description" content="Live departures and arrivals statistics from TLV airport. Updated charts with top destinations and airlines.">
  <meta name="twitter:image" content="https://fly-tlv.com/static/og/flytlv_og.jpg">
  <meta name="twitter:image:alt" content="TLV airport stats overview">

  <!-- Structured Data: Dataset -->
<script type="application/ld+json">
[
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Fly TLV â€” Worldwide Destinations Explorer",
    "url": "https://fly-tlv.com/",
    "inLanguage": "en-US",
    "description": "Explore all destinations worldwide from Tel Aviv (TLV) with airlines, maps, distances, and travel data."
  },
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Fly TLV â€” ×›×œ ×”×™×¢×“×™× ××ª×œ ××‘×™×‘",
    "url": "https://fly-tlv.com/?lang=he",
    "inLanguage": "he-IL",
    "description": "×’×œ×” ××ª ×›×œ ×”×™×¢×“×™× ×‘×¢×•×œ× ××ª×œ ××‘×™×‘ (TLV): ×—×‘×¨×•×ª ×ª×¢×•×¤×”, ××¤×•×ª, ××¨×—×§×™× ×•× ×ª×•× ×™ ×˜×™×¡×”."
  },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Home", "url": "https://fly-tlv.com/" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×‘×™×ª", "url": "https://fly-tlv.com/?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Stats", "url": "https://fly-tlv.com/stats" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "× ×ª×•× ×™ ×©×“×”", "url": "https://fly-tlv.com/stats?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Flights", "url": "https://fly-tlv.com/flights" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×˜×™×¡×•×ª", "url": "https://fly-tlv.com/flights?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "World Map", "url": "https://fly-tlv.com/map" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "××¤×ª ×™×¢×“×™×", "url": "https://fly-tlv.com/map?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Travel Warnings", "url": "https://fly-tlv.com/travel-warnings" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "××–×”×¨×•×ª ××¡×¢", "url": "https://fly-tlv.com/travel-warnings?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Chat", "url": "https://fly-tlv.com/chat" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×¦×³××˜", "url": "https://fly-tlv.com/chat?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "About", "url": "https://fly-tlv.com/about" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×¢×œ×™× ×•", "url": "https://fly-tlv.com/about?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Direct vs Nonstop", "url": "https://fly-tlv.com/direct-vs-nonstop" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×™×©×™×¨ ××•×œ ×œ×œ×-×¢×¦×™×¨×•×ª", "url": "https://fly-tlv.com/direct-vs-nonstop?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Glossary", "url": "https://fly-tlv.com/glossary" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "××™×œ×•×Ÿ ××•× ×—×™×", "url": "https://fly-tlv.com/glossary?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Privacy Policy", "url": "https://fly-tlv.com/privacy" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª", "url": "https://fly-tlv.com/privacy?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Accessibility", "url": "https://fly-tlv.com/accessibility" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "× ×’×™×©×•×ª", "url": "https://fly-tlv.com/accessibility?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Contact", "url": "https://fly-tlv.com/contact" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "×¦×•×¨ ×§×©×¨", "url": "https://fly-tlv.com/contact?lang=he" },

  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "Sitemap", "url": "https://fly-tlv.com/sitemap.xml" },
  { "@context": "https://schema.org", "@type": "SiteNavigationElement", "name": "××¤×ª ××ª×¨", "url": "https://fly-tlv.com/sitemap.xml?lang=he" }
]
</script>
{% endblock %}
{% block content %}
<div class="container-fluid mt-5 text-center">
  <h2 class="mb-2">
    <i class="bi bi-airplane-engines me-2"></i>
    {{ 'Ben Gurion Airport Flight Schedule' if lang != 'he' else '×œ×•×— ×˜×™×¡×•×ª â€” × ××œ ×ª×¢×•×¤×” ×‘×Ÿ ×’×•×¨×™×•×Ÿ' }}
  </h2>
  <span class="last-update-badge d-inline-block mt-2">
    <i class="bi bi-clock-history"></i>
    {{ 'Last update:' if lang != 'he' else '×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”:' }}
    <strong>{{ last_update }}</strong>
  </span>
  <!-- Ads Under Table -->
        <div class="card mt-3 shadow-sm" aria-label="Advertisement">
          <div class="card-header small text-muted fw-semibold">
            <i class="bi bi-airplane-engines me-1 text-primary"></i> Daily Cheap Flight Deals
          </div>
          <div class="card-body text-center p-0">
            <script
              async
              src="https://tpembd.com/content?currency=ils&trs=461563&shmarker=674907.kiwi_under_tb1&locale=en&powered_by=true&limit=4&primary_color=0049AEff&results_background_color=FFFFFF&form_background_color=FFFFFF&promo_id=4563&campaign_id=111"
              charset="utf-8"
            ></script>
          </div>
        </div>
  <div class="table-responsive">
    <table id="flightsTable" class="display table table-bordered table-hover">
      <thead class="table-primary">
        <tr>
          <th>{{ 'Airline' if lang != 'he' else '×—×‘×¨×ª ×ª×¢×•×¤×”' }}</th>
          <th>IATA</th>
          <th>{{ 'Airport' if lang != 'he' else '×©×“×” ×ª×¢×•×¤×”' }}</th>
          <th>{{ 'City' if lang != 'he' else '×¢×™×¨' }}</th>
          <th>{{ 'Country' if lang != 'he' else '××“×™× ×”' }}</th>
          <th>{{ 'Scheduled' if lang != 'he' else '××ª×•×›× × ×ª' }}</th>
          <th>{{ 'Actual' if lang != 'he' else '×©×¢×ª × ×—×™×ª×”/×”××¨××”' }}</th>
          <th>{{ 'Direction' if lang != 'he' else '×›×™×•×•×Ÿ' }}</th>
          <th>{{ 'Status' if lang != 'he' else '×¡×˜×˜×•×¡' }}</th>
        </tr>
      </thead>
      <tbody>
        {% for flight in flights %}
        <tr>
          <td class="airline-cell">
			  {% if flight.airline and flight.airline != "â€”" %}
				{% for airline in flight.airline.split(',') %}
				  {% set airline_name = airline.strip().title() %}
				  {% set website = AIRLINE_WEBSITES.get(airline_name) %}
				  {% if website %}
					<a
					  href="{{ website }}"
					  target="_blank"
					  rel="noopener"
					  class="airline-chip text-decoration-none fw-semibold"
					  title="Visit {{ airline_name | e }} website"
					>
					  {{ airline_name }}
					  <i class="bi bi-box-arrow-up-right ms-1" style="font-size: 0.85em;"></i>
					</a>
				  {% else %}
					<a
					  href="https://www.google.com/search?q={{ airline_name | urlencode }}"
					  target="_blank"
					  rel="noopener"
					  class="airline-chip text-decoration-none fw-semibold"
					  title="Search for {{ airline_name | e }} on Google"
					>
					  {{ airline_name }}
					  <i class="bi bi-search ms-1" style="font-size: 0.85em;"></i>
					</a>
				  {% endif %}
				{% endfor %}
			  {% else %}
				â€”
			  {% endif %}
			</td>
          <td>{{ flight.iata }}</td>
          <td>{{ flight.airport }}</td>
          <td><a href="/destinations/{{ flight.iata }}" class="text-decoration-none fw-bold">{{ flight.city }}</a></td>
          <td>{{ flight.country }}</td>
			<!-- Scheduled -->
			<td title="{{ flight.scheduled_full if flight.scheduled_full else '' }}">
			  {% if flight.scheduled_full %}
				<time datetime="{{ flight.scheduled_full }}">{{ flight.scheduled }}</time>
			  {% else %}
				â€”
			  {% endif %}
			</td>

			<!-- Actual -->
			<td title="{{ flight.actual_full if flight.actual_full else '' }}">
			  {% if flight.actual_iso %}
				<span class="d-none">{{ flight.actual_iso }}</span>  {# ğŸ‘ˆ this makes ISO searchable #}
				<time datetime="{{ flight.actual_iso }}">{{ flight.actual }}</time>
			  {% else %}
				â€”
			  {% endif %}
			</td>

          <td>
            {% if flight.direction == "D" %}
              <span class="badge bg-primary"> {{ 'Departure' if lang != 'he' else '×”××¨××”' }} </span>
            {% elif flight.direction == "A" %}
              <span class="badge bg-success"> {{ 'Arrival' if lang != 'he' else '× ×—×™×ª×”' }} </span>
            {% else %} â€” {% endif %}
          </td>
		<td>
		  {% set s = flight.status|lower %}
		  {% if "on time" in s %}
			<span class="badge bg-success">{{ 'On Time' if lang != 'he' else '×‘×–××Ÿ' }}</span>
		  {% elif "delay" in s %}
			<span class="badge bg-warning text-dark">{{ 'Delayed' if lang != 'he' else '×‘×¢×™×›×•×‘' }}</span>
		  {% elif "cancel" in s %}
			<span class="badge bg-danger">{{ 'Cancelled' if lang != 'he' else '×‘×•×˜×œ×”' }}</span>
		  {% elif "not final" in s %}
			<span class="badge bg-secondary text-white">{{ 'Not Final' if lang != 'he' else '×œ× ×¡×•×¤×™' }}</span>
		  {% else %}
			<span class="badge bg-info text-dark">{{ flight.status }}</span>
		  {% endif %}
		</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
  <!-- Kiwi / Travelpayouts Banner -->
<div class="card mt-3 shadow-sm" aria-label="Advertisement">
  <div class="card-header small text-muted fw-semibold">
    <i class="bi bi-airplane-engines me-1 text-primary"></i>
    {{ 'Cheap Flights' if lang != 'he' else '×˜×™×¡×•×ª ×–×•×œ×•×ª' }}
  </div>
  <div class="card-body text-center">
    <script async src="https://tpembd.com/content?currency=ils&trs=461563&shmarker=674907.flight_banner&locale=en&stops=any&show_hotels=true&powered_by=true&border_radius=30&plain=true&color_button=%232563eb&color_button_text=%23ffffff&promo_id=3414&campaign_id=111"charset="utf-8"></script>
  </div>
</div>
<div class="card mt-3 shadow-sm" aria-label="Advertisement">
  <div class="card-header small text-muted fw-semibold">
	<i class="bi bi-airplane me-1 text-primary"></i>Need an ESIM?
  </div>
  <div class="card-body text-center p-0">
	<script
	  async
	  src="https://tpembd.com/content?trs=461563&shmarker=674907.kiwi_under_tb2&locale=en&powered_by=true&color_button=%230049AE&color_focused=%230049AE&secondary=%23FFFFFF&dark=%2311100f&light=%23FFFFFF&special=%23C4C4C4&border_radius=30&plain=false&no_labels=true&promo_id=8588&campaign_id=541"
	  charset="utf-8"
	></script>
  </div>
</div>
<div class="card mt-3 shadow-sm" aria-label="Advertisement">
  <div class="card-header small text-muted fw-semibold">
	<i class="bi bi-airplane me-1 text-primary"></i>Flight Cancelled or Delayed?
  </div>
  <div class="card-body text-center p-0">
	<script
	  async
	  src="https://tpembd.com/content?trs=461563&shmarker=674907.airhelp_left_1&lang=en&powered_by=true&campaign_id=120&promo_id=8679"
	  charset="utf-8"
	></script>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<style>
  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     TABLE STRUCTURE & CELL ALIGNMENT
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #flightsTable {
    border-collapse: separate !important;
    border-spacing: 0;
    overflow: hidden; /* ensures rounding is visible */
  }

  #flightsTable td,
  #flightsTable thead th {
    text-align: center;
    vertical-align: middle;
  }

  /* Top left & right corners */
  #flightsTable thead th:first-child {
    border-top-left-radius: 12px;
  }
  #flightsTable thead th:last-child {
    border-top-right-radius: 12px;
  }

  /* Bottom left & right corners */
  #flightsTable tbody tr:last-child td:first-child {
    border-bottom-left-radius: 12px;
  }
  #flightsTable tbody tr:last-child td:last-child {
    border-bottom-right-radius: 12px;
  }

  /* Remove bottom line (if needed) */
  #flightsTable tbody tr:last-child td {
    border-bottom: none !important;
  }

  .dataTables_wrapper {
    border-bottom: none !important;
    box-shadow: none !important;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     BADGES (Flight Status)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #flightsTable td .badge {
    display: inline-block;
    min-width: 90px;
    padding: 0.5em 1em;
    font-size: 0.85rem;
    font-weight: 600;
    border-radius: 999px; /* pill shape */
    text-align: center;
    white-space: nowrap;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     DATATABLE BUTTONS (Toolbar)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #flightsTable_wrapper .dt-buttons {
    margin-top: 1rem;
    margin-bottom: 0.8rem;
  }

  #flightsTable_wrapper .dt-buttons .btn {
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #7c3aed, #0ea5e9);
    border: none;
    color: #fff !important;
    font-weight: 500;
    border-radius: 30px;
    padding: 0.45rem 1rem;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
  }

  .dt-buttons .btn:hover {
    background: linear-gradient(135deg, #6d28d9, #0284c7);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  }

  .dt-buttons .btn-outline-secondary {
    background: transparent !important;
    border: 2px solid #0ea5e9 !important;
    color: #0ea5e9 !important;
  }

  .dt-buttons .btn-outline-secondary:hover {
    background: #0ea5e9 !important;
    color: #fff !important;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     FILTER SECTION
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .dt-filters label {
    margin-right: 0.5rem;
    font-weight: 600;
  }

  .dt-filters select {
    display: inline-block;
    width: auto;
  }

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     MOBILE RESPONSIVE STYLES
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  @media (max-width: 768px) {
  /* Layout container rows */
  #flightsTable_wrapper .row.mb-2 {
    flex-direction: column;
    align-items: stretch;
    text-align: center;
    gap: 1rem;
  }

  /* Buttons layout */
  #flightsTable_wrapper .dt-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
  }

  /* Search box styling */
  #flightsTable_wrapper .dataTables_filter {
    margin-top: 1rem;
    text-align: center;
    width: 100%;
  }

  #flightsTable_wrapper .dataTables_filter input {
    width: 90%;
    max-width: 300px;
    margin: 0 auto;
  }

  /* Filters layout: 2 columns */
  .dt-filters {
    width: 100%;
    margin-top: 1rem;
  }

  .dt-filters .d-flex {
    display: grid !important;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    padding: 0 1rem;
  }

  .dt-filters .d-flex > div {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    width: 100%;
  }

  .dt-filters label {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
    text-align: left;
  }

  .dt-filters select {
    width: 100%;
  }

  /* Table horizontal scroll */
  .table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  #flightsTable {
    width: 100% !important;
    min-width: 800px; /* Allows horizontal scroll if needed */
  }

  /* Pagination: show only Prev / Next */
  #flightsTable_wrapper .dataTables_paginate .paginate_button {
    display: none !important;
  }

  #flightsTable_wrapper .dataTables_paginate .previous,
  #flightsTable_wrapper .dataTables_paginate .next {
    display: inline-block !important;
  }

  /* Last update info badge */
  #flightsTable_info {
    text-align: center;
    font-size: 0.85rem;
  }
}

  
</style>

<script>
  $(document).ready(function () {
    const lang = "{{ lang }}";

    const dtButtons = lang === "he" ? [
      { extend: 'copyHtml5', text: '<i class="bi bi-clipboard me-1"></i> ×”×¢×ª×§' },
      { extend: 'csvHtml5',  text: '<i class="bi bi-filetype-csv me-1"></i> CSV' },
      { extend: 'excelHtml5', text: '<i class="bi bi-file-earmark-excel me-1"></i> Excel' },
    ] : [
      { extend: 'copyHtml5', text: '<i class="bi bi-clipboard me-1"></i> Copy' },
      { extend: 'csvHtml5',  text: '<i class="bi bi-filetype-csv me-1"></i> CSV' },
      { extend: 'excelHtml5', text: '<i class="bi bi-file-earmark-excel me-1"></i> Excel' },      
    ];

    const table = $('#flightsTable').DataTable({
	dom: "<'row mb-3 align-items-center'<'col-auto dt-buttons'B><'col-auto dt-filters'><'col-auto'f>>" +
		 "<'row'<'col-12'tr>>" +
		 "<'row mt-2'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6'p>>",
      buttons: dtButtons,
      pageLength: 25,
      responsive: true,
      order: [[5, 'asc']],
	  pagingType: "simple",
      language: {
        url: lang === "he" ? "/static/js/lang.json" : "",
        infoFiltered: ""
      },
      columnDefs: [
        { targets: [0,5,8], responsivePriority: 1 },
        { targets: [1,2], responsivePriority: 2 },
        { targets: [3,4,6], responsivePriority: 10000 },
        { targets: 7, width: "120px", className: "text-center" }, // Direction
        { targets: 8, width: "150px", className: "text-center" }  // Status
      ],
      initComplete: function () {
        // âœ… Style the info element like a "last update" badge
        const info = document.querySelector('#flightsTable_info');
        if (info) {
          info.classList.add('last-update-badge');
        }
		const $search = $('#flightsTable_filter');
		$search.addClass('ms-3 mb-0 d-flex align-items-center'); // spacing + alignment
		$search.find('label').addClass('mb-0'); // tighten label
		$('.dt-filters .d-flex').append($search); // move into toolbar
      }	
    });

    // âœ… Inject filters into toolbar
    $('.dt-filters').html(`
      <div class="d-flex gap-3 flex-wrap align-items-center">
        <div class="d-flex align-items-center">
          <label for="direction-filter" class="me-2">{{ 'Direction' if lang != 'he' else '×›×™×•×•×Ÿ' }}</label>
          <select id="direction-filter" class="form-select form-select-sm">
            <option value="">{{ 'All' if lang != 'he' else '×”×›×œ' }}</option>
            <option value="Departure">{{ 'Departure' if lang != 'he' else '×”××¨××”' }}</option>
            <option value="Arrival">{{ 'Arrival' if lang != 'he' else '× ×—×™×ª×”' }}</option>
          </select>
        </div>
        <div class="d-flex align-items-center">
          <label for="status-filter" class="me-2">{{ 'Status' if lang != 'he' else '×¡×˜×˜×•×¡' }}</label>
          <select id="status-filter" class="form-select form-select-sm">
            <option value="">{{ 'All' if lang != 'he' else '×”×›×œ' }}</option>
            <option value="On Time">{{ 'On Time' if lang != 'he' else '×‘×–××Ÿ' }}</option>
            <option value="Delayed">{{ 'Delayed' if lang != 'he' else '×‘×¢×™×›×•×‘' }}</option>
            <option value="Cancelled">{{ 'Cancelled' if lang != 'he' else '×‘×•×˜×œ×”' }}</option>
            <option value="Not Final">{{ 'Not Final' if lang != 'he' else '×œ× ×¡×•×¤×™' }}</option>
          </select>
        </div>
		<div class="d-flex align-items-center">
			<label for="country-filter" class="me-2">{{ 'Country' if lang != 'he' else '××“×™× ×”' }}</label>
			<select id="country-filter" class="form-select form-select-sm">
				<option value="">{{ 'All' if lang != 'he' else '×”×›×œ' }}</option>
				{% for country in countries %}
				<option value="{{ country }}">{{ country }}</option>
				{% endfor %}
      </select>
		</div>
		<div class="d-flex align-items-center">
	  <label for="actual-date-filter" class="me-2">{{ 'Actual Date' if lang != 'he' else '×ª××¨×™×š ×‘×¤×•×¢×œ' }}</label>
		<select id="actual-date-filter" class="form-select form-select-sm">
		  <option value="">{{ 'All' if lang != 'he' else '×”×›×œ' }}</option>
		  {% for value, label in actual_dates %}
			<option value="{{ value }}">{{ label }}</option>
		  {% endfor %}
		</select>
	</div>
	<div class="d-flex align-items-center">
	  <label for="actual-time-filter" class="me-2">{{ 'Actual Time' if lang != 'he' else '×©×¢×ª ×‘×¤×•×¢×œ' }}</label>
	  <select id="actual-time-filter" class="form-select form-select-sm">
		<option value="">{{ 'All' if lang != 'he' else '×”×›×œ' }}</option>
		{% for t in actual_times %}
		  <option value="{{ t }}">{{ t }}</option>
		{% endfor %}
	  </select>
	</div>
      </div>	  
    `);

    // Filters logic
    $('#direction-filter').on('change', function () {
      table.column(7).search(this.value).draw();
    });
    $('#status-filter').on('change', function () {
      table.column(8).search(this.value).draw();
    });
	$('#country-filter').on('change', function () {
  table.column(4).search(this.value).draw();  
	});
	
	$('#actual-date-filter, #actual-time-filter').on('change', function () {
	  const selDate = $('#actual-date-filter').val(); // e.g. "2025-09-25"
	  const selTime = $('#actual-time-filter').val(); // e.g. "14:15"

	  let regex = '';

	  if (selDate && selTime) {
		regex = `^${selDate}T${selTime}`;  // exact match at start
	  } else if (selDate) {
		regex = `^${selDate}`;  // match any time on that date
	  } else if (selTime) {
		regex = `${selTime}$`;  // match time at end
	  }
	  table.column(6).search(regex, true, false).draw();
	});
    // âœ… Trigger redraw
    $('#actual-date-filter, #actual-time-filter').on('change', function () {
      table.draw();
    });
  });
</script>

{% endblock %}
